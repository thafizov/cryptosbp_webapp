/* iOS Safe Area Utilities */

/* For CSS использующий env() */
.has-safe-area-support {
  /* For padding */
  --safe-area-inset-top: env(safe-area-inset-top);
  --safe-area-inset-right: env(safe-area-inset-right);
  --safe-area-inset-bottom: env(safe-area-inset-bottom);
  --safe-area-inset-left: env(safe-area-inset-left);
}

/* Фоллбэк для браузеров без поддержки env() */
.no-safe-area-support {
  --safe-area-inset-top: 0px;
  --safe-area-inset-right: 0px;
  --safe-area-inset-bottom: 0px;
  --safe-area-inset-left: 0px;
}

/* Специальный класс для нижнего отступа для устройств с Home Indicator */
.has-home-indicator {
  --safe-area-inset-bottom: 34px;
}

/* Telegram WebApp и базовые переменные для панелей */
.telegram-webapp {
  /* Базовые значения панелей */
  --telegram-header-height: 0px;
  --telegram-footer-height: 0px;
  --telegram-webapp-top-inset: var(--telegram-header-height);
  
  /* Для девелоперов: показывает верхний отступ с помощью псевдоэлемента */
  --telegram-show-debug-header: 0; /* 1 для включения */
}

/* Fullscreen mode в Telegram WebApp требует отступов сверху */
.telegram-webapp-fullscreen {
  --telegram-header-height: 65px; /* Стандартная высота панели Telegram */
  --telegram-webapp-top-inset: var(--telegram-header-height);
}

/* Telegram iOS большие устройства (iPhone Pro Max) требуют большего отступа */
@media screen and (min-width: 428px) and (min-height: 926px) {
  .telegram-webapp-fullscreen {
    --telegram-header-height: 85px;
    --telegram-webapp-top-inset: var(--telegram-header-height);
  }
}

/* Динамическое определение отступов на основе размеров устройства через CSS переменные */
.telegram-webapp {
  --screen-width: 100vw; /* Будет перезаписано из JS */
  --screen-height: 100vh; /* Будет перезаписано из JS */
}

/* Отдельный класс для больших устройств (добавляется через JavaScript) */
.telegram-large-device {
  --telegram-header-height: 85px;
  --telegram-webapp-top-inset: var(--telegram-header-height);
}

/* Класс для визуального отображения панели в режиме отладки */
.telegram-webapp-debug::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--telegram-webapp-top-inset);
  background-color: rgba(255, 0, 0, 0.3);
  z-index: 9999;
  pointer-events: none;
  display: var(--telegram-show-debug-header, none);
}

/* Утилиты для использования с Tailwind */
.p-safe-bottom {
  padding-bottom: calc(1rem + var(--safe-area-inset-bottom, 0px));
}

.m-safe-bottom {
  margin-bottom: calc(1rem + var(--safe-area-inset-bottom, 0px));
}

/* Утилиты для верхнего отступа в Telegram */
.p-safe-top {
  padding-top: calc(var(--safe-area-inset-top, 0px) + var(--telegram-webapp-top-inset, 0px));
}

.m-safe-top {
  margin-top: calc(var(--safe-area-inset-top, 0px) + var(--telegram-webapp-top-inset, 0px));
}

/* Фиксированный отступ только на величину панели Telegram */
.p-telegram-header {
  padding-top: var(--telegram-webapp-top-inset, 0px);
}

.m-telegram-header {
  margin-top: var(--telegram-webapp-top-inset, 0px);
}

/* Контейнер с безопасными отступами для Telegram */
.telegram-safe-container {
  padding-top: var(--telegram-webapp-top-inset, 0px);
  padding-bottom: var(--safe-area-inset-bottom, 0px);
  min-height: calc(100vh - var(--telegram-webapp-top-inset, 0px));
  box-sizing: border-box;
}

/* Фикс для fixed-элементов - должны учитывать отступ */
.telegram-fixed-top {
  position: fixed;
  top: var(--telegram-webapp-top-inset, 0px);
  left: 0;
  right: 0;
}

/* Скрипт для обнаружения поддержки Safe Area */
@media (resolution: 1dppx) {
  :root {
    --safe-area-inset-detection: env(safe-area-inset-bottom, 0px);
  }
} 